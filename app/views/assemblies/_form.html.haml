= javascript_tag "var plu = #{@items.to_json(:only => [:id, :code], :methods => :item_name_with_code)};"
= javascript_tag "var model = 'assembly';"

  - semantic_form_for @assembly do |f|
  = f.error_messages
  - f.inputs do
    = f.input :type, :as => :select, :collection => [['Assembling', 'ass'],['Production','prod']], :include_blank => false 
    %li#general_transaction_number_input.string.required
      %label{ :for => 'assembly_number' } Number <span class="required">*</span>
      %input{ :type => :text, :size => 50,
              :name => 'assembly[number]',
              :id => 'assembly_number',
              :value => f.object.attributes['number'],
              :class => 'default' }
      %p.inline-errors= f.error_message_on :number, :append_text => ", but <strong><a href='#' rel='#{@number_suggested}' class='number_suggestion'>#{@number_suggestion}</a></strong> is available"
    = f.input :description, :input_html => { :rows => 3 }

    %li.string
      #items
        %table#transaction_entries.list
          %tr
            %th.td_20 Item Code
            %th.td_70 Item Name
            %th.actions.td_10 Quantity
          - unless @assembly.detail_assemblies.blank?
            - f.semantic_fields_for :detail_assemblies do |entry|
              %tr
                %td.td_20
                  = entry.text_field :item_id, :class => 'plu_code'
                  = entry.hidden_field :item_id
                %td= entry.object.plu.try(:item).try(:name_with_code)
                %td.actions.td_10
                  = entry.text_field :quantity, :size => 10, :class => 'numbers entries_quantity'
                  = entry.hidden_field :item_id

        %p
          %a{:href => '#', :id => 'add_items'}
            = "#{image_tag('icons/silk/add.png')} add  more Items"

  %fieldset.buttons
    %button{ :type => :submit } #{image_tag 'icons/silk/disk.png'} Save Assembling
